<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:vm="clr-namespace:EasyAF.Shell.ViewModels"
                    xmlns:behaviors="clr-namespace:EasyAF.Shell.Behaviors"
                    xmlns:conv="clr-namespace:EasyAF.Shell.Converters">
    
    <!-- CROSS-MODULE EDIT: 2025-01-20 Vertical File Tab System -->
    <!-- Modified for: Add styles and templates for vertical file tab strip -->
    <!-- Related modules: Shell (FileTabItemViewModel, FileTabGroupViewModel) -->
    <!-- Rollback instructions: Delete this entire file -->
    
    <!-- Converters -->
    <conv:BooleanOrToVisibilityConverter x:Key="BooleanOrToVisibilityConverter"/>
    
    <!-- File Tab Group Header Style (module type grouping) -->
    <Style x:Key="FileTabGroupHeaderStyle" TargetType="Border">
        <Setter Property="Background" Value="{DynamicResource SecondaryBackgroundBrush}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource ControlBorderBrush}"/>
        <Setter Property="BorderThickness" Value="0,0,0,1"/>
        <Setter Property="Padding" Value="8,6"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}"/>
            </Trigger>
        </Style.Triggers>
    </Style>
    
    <!-- File Tab Item Style (individual file tab) -->
    <Style x:Key="FileTabItemStyle" TargetType="Border">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0,0,0,1"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Margin" Value="0"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Style.Triggers>
            <!-- Hover state -->
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}"/>
            </Trigger>
            <!-- Active state (set via DataContext binding) -->
            <DataTrigger Binding="{Binding IsActive}" Value="True">
                <Setter Property="Background" Value="{DynamicResource AccentBackgroundBrush}"/>
                <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                <Setter Property="BorderThickness" Value="0,0,3,0"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>
    
    <!-- Close Button Style -->
    <Style x:Key="FileTabCloseButtonStyle" TargetType="Button">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Width" Value="24"/> <!-- Increased from 16 for better touch -->
        <Setter Property="Height" Value="24"/> <!-- Increased from 16 for better touch -->
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Margin" Value="0"/>
        <Setter Property="FontFamily" Value="Segoe MDL2 Assets"/>
        <Setter Property="FontSize" Value="12"/> <!-- Increased from 10 for better visibility -->
        <Setter Property="Content" Value="&#xE711;"/> <!-- Cancel icon -->
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border Background="{TemplateBinding Background}"
                            BorderThickness="0"
                            Padding="{TemplateBinding Padding}"
                            CornerRadius="2">
                        <TextBlock Text="{TemplateBinding Content}"
                                   FontFamily="{TemplateBinding FontFamily}"
                                   FontSize="{TemplateBinding FontSize}"
                                   Foreground="{TemplateBinding Foreground}"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Foreground" Value="#E81123"/> <!-- Red on hover -->
                <Setter Property="Background" Value="#22E81123"/> <!-- Subtle red background on hover -->
            </Trigger>
        </Style.Triggers>
    </Style>
    
    <!-- File Tab Item DataTemplate (implicit) -->
    <DataTemplate DataType="{x:Type vm:FileTabItemViewModel}">
        <Border Style="{StaticResource FileTabItemStyle}"
                behaviors:FileTabBehavior.EnableFileTabBehavior="True">
            
            <Grid Height="72">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="4"/> <!-- Status bar -->
                    <ColumnDefinition Width="32"/> <!-- Icon -->
                    <ColumnDefinition Width="*"/> <!-- Content -->
                    <ColumnDefinition Width="32"/> <!-- Close button (increased from 24) -->
                </Grid.ColumnDefinitions>
                
                <!-- Status Indicator Bar (vertical colored bar) -->
                <Rectangle Grid.Column="0"
                           Fill="{Binding StatusBarBrush}"
                           Width="4"
                           HorizontalAlignment="Left"/>
                
                <!-- Module Icon -->
                <Image Grid.Column="1"
                       Source="{Binding FileTypeIcon}"
                       Width="24"
                       Height="24"
                       Margin="4,0"
                       VerticalAlignment="Center"/>
                
                <!-- File Info (3 lines: name, path, last saved) -->
                <StackPanel Grid.Column="2"
                            Margin="4,8,4,8"
                            VerticalAlignment="Center">
                    <!-- File Name -->
                    <TextBlock Text="{Binding FileName}"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               FontWeight="SemiBold"
                               FontSize="12"
                               TextTrimming="CharacterEllipsis"/>
                    
                    <!-- Directory Path (truncated) -->
                    <TextBlock Text="{Binding DirectoryPath}"
                               Foreground="{DynamicResource TextSecondaryBrush}"
                               FontSize="10"
                               TextTrimming="CharacterEllipsis"
                               Margin="0,2,0,0"/>
                    
                    <!-- Last Saved -->
                    <TextBlock Text="{Binding LastSavedText}"
                               Foreground="{DynamicResource TextTertiaryBrush}"
                               FontSize="9"
                               FontStyle="Italic"
                               Margin="0,2,0,0"/>
                </StackPanel>
                
                <!-- Close Button (X) -->
                <Button Grid.Column="3"
                        Style="{StaticResource FileTabCloseButtonStyle}"
                        Command="{Binding CloseCommand}"
                        CommandParameter="{Binding Document}"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Center"
                        Margin="4,0">
                    <Button.Visibility>
                        <MultiBinding Converter="{StaticResource BooleanOrToVisibilityConverter}">
                            <Binding Path="IsHovered"/>
                            <Binding Path="IsActive"/>
                        </MultiBinding>
                    </Button.Visibility>
                </Button>
            </Grid>
        </Border>
    </DataTemplate>
    
    <!-- File Tab Group DataTemplate (implicit) -->
    <DataTemplate DataType="{x:Type vm:FileTabGroupViewModel}">
        <StackPanel>
            <!-- Group Header -->
            <Border Style="{StaticResource FileTabGroupHeaderStyle}">
                <Border.InputBindings>
                    <MouseBinding Command="{Binding ToggleExpandCommand}"
                                  MouseAction="LeftClick"/>
                </Border.InputBindings>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Expander Triangle -->
                    <TextBlock Grid.Column="0"
                               Text="{Binding ExpanderIcon}"
                               FontFamily="Segoe MDL2 Assets"
                               FontSize="10"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               Margin="0,0,6,0"
                               VerticalAlignment="Center"/>
                    
                    <!-- Module Name -->
                    <TextBlock Grid.Column="1"
                               Text="{Binding Header}"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               FontWeight="SemiBold"
                               FontSize="11"
                               VerticalAlignment="Center"/>
                </Grid>
            </Border>
            
            <!-- Group Items (collapsible) -->
            <ItemsControl ItemsSource="{Binding Items}">
                <ItemsControl.Style>
                    <Style TargetType="ItemsControl">
                        <Setter Property="Visibility" Value="Visible"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsExpanded}" Value="False">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ItemsControl.Style>
            </ItemsControl>
        </StackPanel>
    </DataTemplate>
    
    <!-- Welcome Tab DataTemplate (implicit) -->
    <DataTemplate DataType="{x:Type vm:WelcomeTabViewModel}">
        <Border Background="Transparent"
                BorderBrush="Transparent"
                BorderThickness="0,0,0,1"
                Cursor="Hand"
                behaviors:FileTabBehavior.EnableFileTabBehavior="True">
            <Border.Style>
                <Style TargetType="Border">
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}"/>
                        </Trigger>
                        <DataTrigger Binding="{Binding IsActive}" Value="True">
                            <Setter Property="Background" Value="{DynamicResource AccentBackgroundBrush}"/>
                            <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                            <Setter Property="BorderThickness" Value="0,0,3,0"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
            
            <Grid Height="64">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="40"/> <!-- Icon (centered) -->
                    <ColumnDefinition Width="*"/> <!-- Content -->
                    <ColumnDefinition Width="32"/> <!-- Close button (larger) -->
                </Grid.ColumnDefinitions>
                
                <!-- Welcome Icon (Home glyph) -->
                <TextBlock Grid.Column="0"
                           Text="{Binding IconGlyph}"
                           FontFamily="Segoe MDL2 Assets"
                           FontSize="20"
                           Foreground="{DynamicResource AccentBrush}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"/>
                
                <!-- Welcome Text -->
                <StackPanel Grid.Column="1"
                            Margin="4,8,4,8"
                            VerticalAlignment="Center">
                    <!-- Display Name -->
                    <TextBlock Text="{Binding DisplayName}"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               FontWeight="SemiBold"
                               FontSize="13"
                               TextTrimming="CharacterEllipsis"/>
                    
                    <!-- Description -->
                    <TextBlock Text="{Binding Description}"
                               Foreground="{DynamicResource TextSecondaryBrush}"
                               FontSize="10"
                               TextTrimming="CharacterEllipsis"
                               Margin="0,2,0,0"/>
                </StackPanel>
                
                <!-- No close button for Welcome tab (permanently hidden) -->
            </Grid>
        </Border>
    </DataTemplate>

</ResourceDictionary>
