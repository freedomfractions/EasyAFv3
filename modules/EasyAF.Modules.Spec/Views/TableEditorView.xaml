<UserControl x:Class="EasyAF.Modules.Spec.Views.TableEditorView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:converters="clr-namespace:EasyAF.Modules.Spec.Converters"
             Background="{DynamicResource PrimaryBackgroundBrush}">
    
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/EasyAF.Modules.Spec;component/Styles/SpecEditorStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- Converters -->
            <converters:NullToBooleanConverter x:Key="NullToBooleanConverter"/>
            
            <!-- Expander Style matching GroupBox appearance -->
            <Style x:Key="TableConfigExpanderStyle" TargetType="Expander">
                <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
                <Setter Property="BorderBrush" Value="{DynamicResource ControlBorderBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Margin" Value="0,0,0,8"/>
                <Setter Property="IsExpanded" Value="True"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Expander">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4">
                                <DockPanel>
                                    <!-- Header with validation icon -->
                                    <Border DockPanel.Dock="Top"
                                            Background="{DynamicResource SecondaryBackgroundBrush}"
                                            BorderBrush="{DynamicResource ControlBorderBrush}"
                                            BorderThickness="0,0,0,1"
                                            Padding="8,4">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <!-- Expander toggle button -->
                                            <ToggleButton Grid.Column="0"
                                                          IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
                                                          VerticalAlignment="Center"
                                                          Margin="0,0,6,0">
                                                <ToggleButton.Style>
                                                    <Style TargetType="ToggleButton">
                                                        <Setter Property="Background" Value="Transparent"/>
                                                        <Setter Property="BorderThickness" Value="0"/>
                                                        <Setter Property="Padding" Value="0"/>
                                                        <Setter Property="Width" Value="16"/>
                                                        <Setter Property="Height" Value="16"/>
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="ToggleButton">
                                                                    <Border Background="{TemplateBinding Background}">
                                                                        <TextBlock FontFamily="Segoe MDL2 Assets"
                                                                                   FontSize="12"
                                                                                   HorizontalAlignment="Center"
                                                                                   VerticalAlignment="Center"
                                                                                   Foreground="{DynamicResource TextPrimaryBrush}">
                                                                            <TextBlock.Style>
                                                                                <Style TargetType="TextBlock">
                                                                                    <Setter Property="Text" Value="&#xE76C;"/> <!-- ChevronRight -->
                                                                                    <Style.Triggers>
                                                                                        <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource TemplatedParent}}" Value="True">
                                                                                            <Setter Property="Text" Value="&#xE70D;"/> <!-- ChevronDown -->
                                                                                        </DataTrigger>
                                                                                    </Style.Triggers>
                                                                                </Style>
                                                                            </TextBlock.Style>
                                                                        </TextBlock>
                                                                    </Border>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </ToggleButton.Style>
                                            </ToggleButton>
                                            
                                            <!-- Header text -->
                                            <ContentPresenter Grid.Column="1"
                                                              Content="{TemplateBinding Header}"
                                                              VerticalAlignment="Center"/>
                                            
                                            <!-- Validation icon (bound in DataContext) -->
                                            <TextBlock Grid.Column="2"
                                                       FontFamily="Segoe MDL2 Assets"
                                                       FontSize="14"
                                                       VerticalAlignment="Center"
                                                       Margin="8,0,0,0"
                                                       Text="{Binding Tag, RelativeSource={RelativeSource TemplatedParent}}"
                                                       Foreground="{DynamicResource SuccessBrush}"/>
                                        </Grid>
                                    </Border>
                                    
                                    <!-- Content area -->
                                    <ContentPresenter x:Name="Content"
                                                      Margin="8"
                                                      Visibility="Collapsed"/>
                                </DockPanel>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsExpanded" Value="True">
                                    <Setter TargetName="Content" Property="Visibility" Value="Visible"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    
    <!-- Wrap entire content in ScrollViewer -->
    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled">
        <!-- Main Grid with 3 rows: Upper Section, GridSplitter, Lower Section -->
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" MinHeight="200"/>
                <RowDefinition Height="4"/>
                <RowDefinition Height="Auto" MinHeight="200"/>
            </Grid.RowDefinitions>
            
            <!-- UPPER SECTION: Table Configuration -->
            <StackPanel Grid.Row="0">
                <!-- Table Properties Expander -->
                <Expander Style="{StaticResource TableConfigExpanderStyle}"
                          Tag="&#xE73E;"> <!-- Checkmark icon -->
                    <Expander.Header>
                        <TextBlock Text="Table Properties"
                                   FontWeight="SemiBold"
                                   FontSize="13"
                                   Foreground="{DynamicResource TextPrimaryBrush}"/>
                    </Expander.Header>
                    
                    <Grid Margin="4">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Row 0: Table Name | Mode | Hide if no diff -->
                        <TextBlock Grid.Row="0" Grid.Column="0"
                                   Text="Table Name:"
                                   VerticalAlignment="Center"
                                   Margin="0,0,8,0"
                                   Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <TextBox Grid.Row="0" Grid.Column="1"
                                 Text="{Binding TableName, UpdateSourceTrigger=PropertyChanged}"
                                 Background="{DynamicResource ControlBackgroundBrush}"
                                 Foreground="{DynamicResource TextPrimaryBrush}"
                                 BorderBrush="{DynamicResource ControlBorderBrush}"
                                 Padding="4"
                                 MinWidth="200"/>
                        
                        <StackPanel Grid.Row="0" Grid.Column="2"
                                    Orientation="Horizontal"
                                    Margin="16,0,0,0">
                            <TextBlock Text="Mode:"
                                       VerticalAlignment="Center"
                                       Margin="0,0,8,0"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <ComboBox Width="80"
                                      SelectedValue="{Binding Mode, UpdateSourceTrigger=PropertyChanged}"
                                      SelectedValuePath="Tag"
                                      Background="{DynamicResource ControlBackgroundBrush}"
                                      Foreground="{DynamicResource TextPrimaryBrush}"
                                      BorderBrush="{DynamicResource ControlBorderBrush}">
                                <ComboBoxItem Content="New" Tag="new"/>
                                <ComboBoxItem Content="Diff" Tag="diff"/>
                                <ComboBoxItem Content="Old" Tag="old"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <CheckBox Grid.Row="0" Grid.Column="3"
                                  Content="Hide if no diff"
                                  IsChecked="{Binding HideIfNoDiff, UpdateSourceTrigger=PropertyChanged}"
                                  IsEnabled="{Binding IsDiffMode}"
                                  Margin="16,0,0,0"
                                  VerticalAlignment="Center"
                                  Foreground="{DynamicResource TextPrimaryBrush}"/>
                        
                        <!-- Row 2: Pagination -->
                        <TextBlock Grid.Row="2" Grid.Column="0"
                                   Text="Pagination:"
                                   VerticalAlignment="Center"
                                   Margin="0,0,8,0"
                                   Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <CheckBox Grid.Row="2" Grid.Column="1"
                                  Grid.ColumnSpan="3"
                                  Content="Allow row break across pages"
                                  IsChecked="{Binding AllowRowBreakAcrossPages, UpdateSourceTrigger=PropertyChanged}"
                                  VerticalAlignment="Center"
                                  Foreground="{DynamicResource TextPrimaryBrush}"/>
                    </Grid>
                </Expander>
                
                <!-- Filters Expander -->
                <Expander Style="{StaticResource TableConfigExpanderStyle}" IsExpanded="False">
                    <Expander.Header>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Filters"
                                       FontWeight="SemiBold"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <TextBlock Text="{Binding FilterCount, StringFormat=' ({0})'}"
                                       FontWeight="Normal"
                                       FontSize="11"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       VerticalAlignment="Bottom"
                                       Margin="4,0,0,1"/>
                        </StackPanel>
                    </Expander.Header>
                    
                    <Grid Margin="4">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/> <!-- Toolbar -->
                            <RowDefinition Height="*"/>    <!-- DataGrid -->
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/> <!-- Filter Logic Dropdown -->
                        </Grid.RowDefinitions>
                        
                        <!-- Toolbar -->
                        <ToolBar Grid.Row="0" 
                                 Background="{DynamicResource SecondaryBackgroundBrush}"
                                 BorderBrush="{DynamicResource ControlBorderBrush}">
                            <Button Content="Add Filter" 
                                    Command="{Binding AddFilterCommand}"
                                    Style="{StaticResource ToolBarButtonStyle}"/>
                            <Button Content="Remove" 
                                    Command="{Binding RemoveFilterCommand}"
                                    Style="{StaticResource ToolBarButtonStyle}"/>
                            <Separator/>
                            <Button Content="Edit..." 
                                    Command="{Binding EditFilterCommand}"
                                    Style="{StaticResource ToolBarButtonStyle}"/>
                        </ToolBar>
                        
                        <!-- Filters DataGrid (READ-ONLY - double-click to edit) -->
                        <DataGrid Grid.Row="1" 
                                  ItemsSource="{Binding Filters}"
                                  SelectedItem="{Binding SelectedFilter}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  IsReadOnly="True"
                                  HeadersVisibility="Column"
                                  Background="{DynamicResource ControlBackgroundBrush}"
                                  Foreground="{DynamicResource TextPrimaryBrush}"
                                  BorderBrush="{DynamicResource ControlBorderBrush}"
                                  BorderThickness="1"
                                  Margin="0,8,0,0"
                                  ColumnHeaderStyle="{StaticResource ColumnEditorHeaderStyle}"
                                  RowStyle="{StaticResource ColumnEditorRowStyle}"
                                  GridLinesVisibility="Horizontal"
                                  HorizontalGridLinesBrush="{DynamicResource ControlBorderBrush}"
                                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                  MinHeight="120"
                                  MaxHeight="200"
                                  MouseDoubleClick="FiltersDataGrid_MouseDoubleClick">
                            <DataGrid.Columns>
                                <!-- Rule # Column -->
                                <DataGridTextColumn Header="Rule #" 
                                                    Binding="{Binding RuleNumber}" 
                                                    Width="60">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ColumnEditorHeaderStyle}">
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center"/>
                                            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="Cursor" Value="Hand"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                
                                <!-- Summary Column -->
                                <DataGridTextColumn Header="Filter Rule" 
                                                    Binding="{Binding Summary}" 
                                                    Width="*">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                            <Setter Property="TextWrapping" Value="NoWrap"/>
                                            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                            <Setter Property="ToolTip" Value="{Binding Summary}"/>
                                            <Setter Property="Cursor" Value="Hand"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                
                                <!-- Type Indicator -->
                                <DataGridTemplateColumn Header="Type" Width="80">
                                    <DataGridTemplateColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ColumnEditorHeaderStyle}">
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridTemplateColumn.HeaderStyle>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock HorizontalAlignment="Center"
                                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                                       Cursor="Hand">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Text" Value="Text"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Numeric}" Value="True">
                                                                <Setter Property="Text" Value="Numeric"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                        
                        <!-- Filter Logic Dropdown -->
                        <Grid Grid.Row="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="150"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0"
                                       Text="Apply filters using:"
                                       VerticalAlignment="Center"
                                       Margin="0,0,8,0"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                            
                            <ComboBox Grid.Column="1"
                                      SelectedValue="{Binding FilterLogic, UpdateSourceTrigger=PropertyChanged}"
                                      SelectedValuePath="Tag"
                                      Background="{DynamicResource ControlBackgroundBrush}"
                                      Foreground="{DynamicResource TextPrimaryBrush}"
                                      BorderBrush="{DynamicResource ControlBorderBrush}">
                                <ComboBoxItem Content="AND (all must match)" Tag="AND" IsSelected="True"/>
                                <ComboBoxItem Content="OR (any must match)" Tag="OR"/>
                                <ComboBoxItem Content="Advanced..." Tag="Advanced"/>
                            </ComboBox>
                            
                            <!-- Advanced logic hint (shown when Advanced selected) -->
                            <TextBlock Grid.Column="2"
                                       Text="Use rule numbers in logic: e.g., '(1 | 2) &amp; 3'"
                                       VerticalAlignment="Center"
                                       Margin="12,0,0,0"
                                       FontStyle="Italic"
                                       FontSize="11"
                                       Foreground="{DynamicResource TextSecondaryBrush}">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                        <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsAdvancedFilterLogic}" Value="True">
                                                <Setter Property="Visibility" Value="Visible"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                        
                        <!-- Empty State Overlay -->
                        <Border Grid.Row="1"
                                Background="{DynamicResource WindowBackgroundBrush}"
                                Opacity="0.95"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center"
                                CornerRadius="8"
                                Padding="24,16"
                                BorderBrush="{DynamicResource ControlBorderBrush}"
                                BorderThickness="2"
                                IsHitTestVisible="False">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                    <Setter Property="Opacity" Value="0.95"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Filters.Count}" Value="0">
                                            <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            
                            <StackPanel MaxWidth="300">
                                <TextBlock Text="&#xE71C;"
                                           FontFamily="Segoe MDL2 Assets"
                                           FontSize="36"
                                           HorizontalAlignment="Center"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           Margin="0,0,0,12"/>
                                
                                <TextBlock Text="No Filters Defined"
                                           FontSize="14"
                                           FontWeight="SemiBold"
                                           HorizontalAlignment="Center"
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           Margin="0,0,0,6"/>
                                
                                <TextBlock TextWrapping="Wrap"
                                           TextAlignment="Center"
                                           FontSize="11"
                                           Foreground="{DynamicResource TextSecondaryBrush}">
                                    <Run Text="Click"/>
                                    <Run Text="Add Filter" FontWeight="Bold"/>
                                    <Run Text="to include/exclude rows. Double-click a filter to edit it."/>
                                </TextBlock>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Expander>
                
                <!-- Sorting Expander -->
                <Expander Style="{StaticResource TableConfigExpanderStyle}" IsExpanded="False">
                    <Expander.Header>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Sorting"
                                       FontWeight="SemiBold"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                            <TextBlock Text="{Binding SortSpecCount, StringFormat=' ({0})'}"
                                       FontWeight="Normal"
                                       FontSize="11"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       VerticalAlignment="Bottom"
                                       Margin="4,0,0,1"/>
                        </StackPanel>
                    </Expander.Header>
                    
                    <Grid Margin="4">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/> <!-- Toolbar -->
                            <RowDefinition Height="*"/>    <!-- DataGrid -->
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/> <!-- Sort Details Panel -->
                        </Grid.RowDefinitions>
                    
                        <!-- Toolbar -->
                        <ToolBar Grid.Row="0" 
                                 Background="{DynamicResource SecondaryBackgroundBrush}"
                                 BorderBrush="{DynamicResource ControlBorderBrush}">
                            <Button Content="Add Sort" 
                                    Command="{Binding AddSortSpecCommand}"
                                    Style="{StaticResource ToolBarButtonStyle}"/>
                            <Button Content="Remove" 
                                    Command="{Binding RemoveSortSpecCommand}"
                                    Style="{StaticResource ToolBarButtonStyle}"/>
                            <Separator/>
                            <Button ToolTip="Move Up (Higher Priority)"
                                    Command="{Binding MoveSortSpecUpCommand}"
                                    Style="{StaticResource ToolBarButtonStyle}"
                                    Width="32">
                                <TextBlock Text="&#xE70E;" 
                                           FontFamily="Segoe MDL2 Assets"
                                           FontSize="14"
                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                            </Button>
                            <Button ToolTip="Move Down (Lower Priority)"
                                    Command="{Binding MoveSortSpecDownCommand}"
                                    Style="{StaticResource ToolBarButtonStyle}"
                                    Width="32">
                                <TextBlock Text="&#xE70D;" 
                                           FontFamily="Segoe MDL2 Assets"
                                           FontSize="14"
                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                            </Button>
                        </ToolBar>
                        
                        <!-- Sort Specs DataGrid -->
                        <DataGrid Grid.Row="1" 
                                  ItemsSource="{Binding SortSpecs}"
                                  SelectedItem="{Binding SelectedSortSpec}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  HeadersVisibility="Column"
                                  Background="{DynamicResource ControlBackgroundBrush}"
                                  Foreground="{DynamicResource TextPrimaryBrush}"
                                  BorderBrush="{DynamicResource ControlBorderBrush}"
                                  BorderThickness="1"
                                  Margin="0,8,0,0"
                                  ColumnHeaderStyle="{StaticResource ColumnEditorHeaderStyle}"
                                  RowStyle="{StaticResource ColumnEditorRowStyle}"
                                  GridLinesVisibility="Horizontal"
                                  HorizontalGridLinesBrush="{DynamicResource ControlBorderBrush}"
                                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                                  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                  MinHeight="100"
                                  MaxHeight="150">
                            <DataGrid.Columns>
                                <!-- Order Column -->
                                <DataGridTextColumn Header="Priority" Binding="{Binding OrderIndex}" Width="70" IsReadOnly="True">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ColumnEditorHeaderStyle}">
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center"/>
                                            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                
                                <!-- Column Number - EDITABLE -->
                                <DataGridTextColumn Header="Column #" 
                                                    Binding="{Binding Column, UpdateSourceTrigger=PropertyChanged}" 
                                                    Width="80">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ColumnEditorHeaderStyle}">
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center"/>
                                            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                    <DataGridTextColumn.EditingElementStyle>
                                        <Style TargetType="TextBox">
                                            <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
                                            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                            <Setter Property="BorderBrush" Value="{DynamicResource ControlBorderBrush}"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridTextColumn.EditingElementStyle>
                                </DataGridTextColumn>
                                
                                <!-- Column Header - READ-ONLY -->
                                <DataGridTextColumn Header="Column Header" 
                                                    Binding="{Binding ColumnHeader, Mode=OneWay}" 
                                                    Width="180"
                                                    IsReadOnly="True">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
                                            <Setter Property="FontStyle" Value="Italic"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                
                                <!-- Direction - Template Column with ComboBox -->
                                <DataGridTemplateColumn Header="Direction" Width="150">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding DirectionDisplay}"
                                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                                       VerticalAlignment="Center"
                                                       Margin="4,0"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                    <DataGridTemplateColumn.CellEditingTemplate>
                                        <DataTemplate>
                                            <ComboBox SelectedValue="{Binding Direction, UpdateSourceTrigger=PropertyChanged}"
                                                      SelectedValuePath="Tag"
                                                      Background="{DynamicResource ControlBackgroundBrush}"
                                                      Foreground="{DynamicResource TextPrimaryBrush}"
                                                      BorderBrush="{DynamicResource ControlBorderBrush}">
                                                <ComboBoxItem Content="Ascending ?" Tag="asc"/>
                                                <ComboBoxItem Content="Descending ?" Tag="desc"/>
                                            </ComboBox>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellEditingTemplate>
                                </DataGridTemplateColumn>
                                
                                <!-- Numeric - CHECKBOX -->
                                <DataGridCheckBoxColumn Header="Numeric" 
                                                        Binding="{Binding Numeric, UpdateSourceTrigger=PropertyChanged}" 
                                                        Width="*">
                                    <DataGridCheckBoxColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ColumnEditorHeaderStyle}">
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        </Style>
                                    </DataGridCheckBoxColumn.HeaderStyle>
                                    <DataGridCheckBoxColumn.ElementStyle>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="HorizontalAlignment" Value="Center"/>
                                            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                        </Style>
                                    </DataGridCheckBoxColumn.ElementStyle>
                                </DataGridCheckBoxColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                        
                        <!-- Sort Details Panel (shows summary when item selected) -->
                        <Border Grid.Row="3"
                                Background="{DynamicResource SecondaryBackgroundBrush}"
                                BorderBrush="{DynamicResource ControlBorderBrush}"
                                BorderThickness="1"
                                CornerRadius="4"
                                Padding="8,6">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SelectedSortSpec, Converter={StaticResource NullToBooleanConverter}}" Value="True">
                                            <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            
                            <StackPanel Orientation="Horizontal" DataContext="{Binding SelectedSortSpec}">
                                <TextBlock Text="&#xE8CB;"
                                           FontFamily="Segoe MDL2 Assets"
                                           FontSize="14"
                                           Foreground="{DynamicResource AccentBrush}"
                                           VerticalAlignment="Center"
                                           Margin="0,0,8,0"/>
                                <TextBlock Text="{Binding Summary}"
                                           FontSize="12"
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- Empty State Overlay -->
                        <Border Grid.Row="1"
                                Background="{DynamicResource WindowBackgroundBrush}"
                                Opacity="0.95"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Center"
                                CornerRadius="8"
                                Padding="24,16"
                                BorderBrush="{DynamicResource ControlBorderBrush}"
                                BorderThickness="2"
                                IsHitTestVisible="False">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                    <Setter Property="Opacity" Value="0.95"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SortSpecs.Count}" Value="0">
                                            <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            
                            <StackPanel MaxWidth="300">
                                <TextBlock Text="&#xE8CB;"
                                           FontFamily="Segoe MDL2 Assets"
                                           FontSize="36"
                                           HorizontalAlignment="Center"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           Margin="0,0,0,12"/>
                                
                                <TextBlock Text="No Sorting Defined"
                                           FontSize="14"
                                           FontWeight="SemiBold"
                                           HorizontalAlignment="Center"
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           Margin="0,0,0,6"/>
                                
                                <TextBlock TextWrapping="Wrap"
                                           TextAlignment="Center"
                                           FontSize="11"
                                           Foreground="{DynamicResource TextSecondaryBrush}">
                                    <Run Text="Click"/>
                                    <Run Text="Add Sort" FontWeight="Bold"/>
                                    <Run Text="to sort table rows. Higher priority sorts are applied first."/>
                                </TextBlock>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Expander>
                
                <!-- Empty Message Expander -->
                <Expander Style="{StaticResource TableConfigExpanderStyle}"
                          IsExpanded="False">
                    <Expander.Header>
                        <TextBlock Text="Empty Message"
                                   FontWeight="SemiBold"
                                   FontSize="13"
                                   Foreground="{DynamicResource TextPrimaryBrush}"/>
                    </Expander.Header>
                    
                    <Grid Margin="4">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/> <!-- Message TextBox -->
                            <RowDefinition Height="8"/>
                            <RowDefinition Height="Auto"/> <!-- Formatting Expander -->
                        </Grid.RowDefinitions>
                        
                        <!-- Empty Message TextBox -->
                        <Grid Grid.Row="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0"
                                       Text="Message displayed when table has no data:"
                                       Margin="0,0,0,4"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       FontSize="11"/>
                            
                            <TextBox Grid.Row="1"
                                     Text="{Binding EmptyMessage, UpdateSourceTrigger=PropertyChanged}"
                                     Background="{DynamicResource ControlBackgroundBrush}"
                                     Foreground="{DynamicResource TextPrimaryBrush}"
                                     BorderBrush="{DynamicResource ControlBorderBrush}"
                                     Padding="6"
                                     TextWrapping="Wrap"
                                     AcceptsReturn="False"
                                     MinHeight="60"/>
                        </Grid>
                        
                        <!-- Formatting Expander -->
                        <Expander Grid.Row="2"
                                  Header="Formatting Options"
                                  IsExpanded="{Binding IsEmptyFormattingExpanded}"
                                  BorderBrush="{DynamicResource ControlBorderBrush}"
                                  BorderThickness="1"
                                  Padding="8">
                            <Expander.Style>
                                <Style TargetType="Expander">
                                    <Setter Property="Background" Value="{DynamicResource SecondaryBackgroundBrush}"/>
                                    <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                </Style>
                            </Expander.Style>
                            <Grid Margin="4">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="8"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Row 0: Font | Fill Color | Text Color buttons -->
                                <TextBlock Grid.Row="0" Grid.Column="0"
                                           Text="Style:"
                                           VerticalAlignment="Center"
                                           Margin="0,0,12,0"
                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <StackPanel Grid.Row="0" Grid.Column="1"
                                            Orientation="Horizontal">
                                    <Button Content="Font..."
                                            Command="{Binding ChooseEmptyFontCommand}"
                                            Style="{StaticResource BaseButtonStyle}"
                                            Padding="12,6"
                                            MinWidth="80"
                                            ToolTip="Choose font, size, and style"/>
                                    <Button Content="Fill Color..."
                                            Command="{Binding ChooseEmptyFillColorCommand}"
                                            Style="{StaticResource BaseButtonStyle}"
                                            Padding="12,6"
                                            MinWidth="100"
                                            Margin="8,0,0,0"
                                            ToolTip="Choose background color"/>
                                    <Button Content="Text Color..."
                                            Command="{Binding ChooseEmptyTextColorCommand}"
                                            Style="{StaticResource BaseButtonStyle}"
                                            Padding="12,6"
                                            MinWidth="100"
                                            Margin="8,0,0,0"
                                            ToolTip="Choose text color"/>
                                </StackPanel>
                                
                                <!-- Row 2: Alignment Dropdowns | Clear Formatting -->
                                <TextBlock Grid.Row="2" Grid.Column="0"
                                           Text="Alignment:"
                                           VerticalAlignment="Center"
                                           Margin="0,0,12,0"
                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <StackPanel Grid.Row="2" Grid.Column="1"
                                            Orientation="Horizontal">
                                    <ComboBox Width="120"
                                              SelectedValue="{Binding EmptyHorizontalAlignment, UpdateSourceTrigger=PropertyChanged}"
                                              SelectedValuePath="Tag"
                                              Background="{DynamicResource ControlBackgroundBrush}"
                                              Foreground="{DynamicResource TextPrimaryBrush}"
                                              BorderBrush="{DynamicResource ControlBorderBrush}"
                                              ToolTip="Horizontal alignment">
                                        <ComboBoxItem Content="Left" Tag="left"/>
                                        <ComboBoxItem Content="Center" Tag="center" IsSelected="True"/>
                                        <ComboBoxItem Content="Right" Tag="right"/>
                                    </ComboBox>
                                    <ComboBox Width="120"
                                              Margin="8,0,0,0"
                                              SelectedValue="{Binding EmptyVerticalAlignment, UpdateSourceTrigger=PropertyChanged}"
                                              SelectedValuePath="Tag"
                                              Background="{DynamicResource ControlBackgroundBrush}"
                                              Foreground="{DynamicResource TextPrimaryBrush}"
                                              BorderBrush="{DynamicResource ControlBorderBrush}"
                                              ToolTip="Vertical alignment">
                                        <ComboBoxItem Content="Top" Tag="top"/>
                                        <ComboBoxItem Content="Center" Tag="center" IsSelected="True"/>
                                        <ComboBoxItem Content="Bottom" Tag="bottom"/>
                                    </ComboBox>
                                    <Button Content="Clear Formatting"
                                            Command="{Binding ClearEmptyFormattingCommand}"
                                            Padding="12,6"
                                            Margin="16,0,0,0"
                                            Style="{StaticResource BaseButtonStyle}"/>
                                </StackPanel>
                            </Grid>
                        </Expander>
                    </Grid>
                </Expander>
            </StackPanel>
            
            <!-- GridSplitter for resizing -->
            <GridSplitter Grid.Row="1"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          Background="{DynamicResource ControlBorderBrush}"
                          ShowsPreview="True"/>
            
            <!-- LOWER SECTION: Columns (existing implementation) -->
            <GroupBox Grid.Row="2"
                      Header="Columns"
                      Foreground="{DynamicResource TextPrimaryBrush}"
                      BorderBrush="{DynamicResource ControlBorderBrush}">
                <Grid Margin="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/> <!-- Toolbar -->
                        <RowDefinition Height="*"/>    <!-- DataGrid -->
                    </Grid.RowDefinitions>
                    
                    <!-- Toolbar -->
                    <ToolBar Grid.Row="0" 
                             Background="{DynamicResource SecondaryBackgroundBrush}"
                             BorderBrush="{DynamicResource ControlBorderBrush}">
                        <Button Content="Add Column" 
                                Command="{Binding AddColumnCommand}"
                                Style="{StaticResource ToolBarButtonStyle}"/>
                        <Button Content="Remove" 
                                Command="{Binding RemoveColumnCommand}"
                                Style="{StaticResource ToolBarButtonStyle}"/>
                        <Separator/>
                        <Button ToolTip="Move Up"
                                Command="{Binding MoveColumnUpCommand}"
                                Style="{StaticResource ToolBarButtonStyle}"
                                Width="32">
                            <TextBlock Text="&#xE70E;" 
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="14"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </Button>
                        <Button ToolTip="Move Down"
                                Command="{Binding MoveColumnDownCommand}"
                                Style="{StaticResource ToolBarButtonStyle}"
                                Width="32">
                            <TextBlock Text="&#xE70D;" 
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="14"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </Button>
                        <Separator/>
                        <Button Content="Edit..." 
                                Command="{Binding EditColumnCommand}"
                                Style="{StaticResource ToolBarButtonStyle}"/>
                    </ToolBar>
                    
                    <!-- Columns DataGrid -->
                    <DataGrid Grid.Row="1" 
                              ItemsSource="{Binding Columns}"
                              SelectedItem="{Binding SelectedColumn}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              HeadersVisibility="Column"
                              Background="{DynamicResource ControlBackgroundBrush}"
                              Foreground="{DynamicResource TextPrimaryBrush}"
                              BorderBrush="{DynamicResource ControlBorderBrush}"
                              BorderThickness="1"
                              Margin="0,8,0,0"
                              ColumnHeaderStyle="{StaticResource ColumnEditorHeaderStyle}"
                              RowStyle="{StaticResource ColumnEditorRowStyle}"
                              CellStyle="{StaticResource ColumnEditorCellStyle}"
                              GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="{DynamicResource ControlBorderBrush}"
                              RowBackground="{DynamicResource ControlBackgroundBrush}"
                              AlternatingRowBackground="{DynamicResource PrimaryBackgroundBrush}"
                              ScrollViewer.VerticalScrollBarVisibility="Auto"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                              ScrollViewer.CanContentScroll="False">
                        <DataGrid.Columns>
                            <!-- Order Column -->
                            <DataGridTextColumn Header="#" 
                                                Binding="{Binding OrderIndex}" 
                                                Width="40"
                                                IsReadOnly="True">
                                <DataGridTextColumn.HeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ColumnEditorHeaderStyle}">
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.HeaderStyle>
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            
                            <!-- Column Header - EDITABLE -->
                            <DataGridTextColumn Header="Column Header" 
                                                Binding="{Binding ColumnHeader, UpdateSourceTrigger=PropertyChanged}" 
                                                Width="200">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                                <DataGridTextColumn.EditingElementStyle>
                                    <Style TargetType="TextBox">
                                        <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
                                        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                        <Setter Property="BorderBrush" Value="{DynamicResource ControlBorderBrush}"/>
                                        <Setter Property="CaretBrush" Value="{DynamicResource TextPrimaryBrush}"/>
                                    </Style>
                                </DataGridTextColumn.EditingElementStyle>
                            </DataGridTextColumn>
                            
                            <!-- Property Paths - BUTTON to open picker -->
                            <DataGridTemplateColumn Header="Property Paths" Width="250">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding PropertyPathsDisplay}" 
                                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                                   TextTrimming="CharacterEllipsis"
                                                   ToolTip="{Binding PropertyPathsDisplay}"
                                                   Cursor="Hand"
                                                   MouseLeftButtonDown="PropertyPaths_MouseLeftButtonDown"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            
                            <!-- Width Percent - EDITABLE -->
                            <DataGridTextColumn Header="Width %" 
                                                Binding="{Binding WidthPercent, UpdateSourceTrigger=PropertyChanged}" 
                                                Width="80">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                                <DataGridTextColumn.EditingElementStyle>
                                    <Style TargetType="TextBox">
                                        <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
                                        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                        <Setter Property="BorderBrush" Value="{DynamicResource ControlBorderBrush}"/>
                                        <Setter Property="CaretBrush" Value="{DynamicResource TextPrimaryBrush}"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.EditingElementStyle>
                            </DataGridTextColumn>
                            
                            <!-- Format - EDITABLE -->
                            <DataGridTextColumn Header="Format" 
                                                Binding="{Binding FormatDisplay, UpdateSourceTrigger=PropertyChanged}" 
                                                Width="*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                                <DataGridTextColumn.EditingElementStyle>
                                    <Style TargetType="TextBox">
                                        <Setter Property="Background" Value="{DynamicResource ControlBackgroundBrush}"/>
                                        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}"/>
                                        <Setter Property="BorderBrush" Value="{DynamicResource ControlBorderBrush}"/>
                                        <Setter Property="CaretBrush" Value="{DynamicResource TextPrimaryBrush}"/>
                                    </Style>
                                </DataGridTextColumn.EditingElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    
                    <!-- Empty State Overlay -->
                    <Border Grid.Row="1"
                            Background="{DynamicResource WindowBackgroundBrush}"
                            Opacity="0.95"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center"
                            CornerRadius="8"
                            Padding="32,24"
                            BorderBrush="{DynamicResource ControlBorderBrush}"
                            BorderThickness="2"
                            Margin="10"
                            IsHitTestVisible="False">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Columns.Count}" Value="0">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        
                        <StackPanel MaxWidth="350">
                            <!-- Icon -->
                            <TextBlock Text="&#xE8EF;"
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="48"
                                       HorizontalAlignment="Center"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       Margin="0,0,0,16"/>
                            
                            <!-- Title -->
                            <TextBlock Text="No Columns Defined"
                                       FontSize="16"
                                       FontWeight="SemiBold"
                                       HorizontalAlignment="Center"
                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                       Margin="0,0,0,8"/>
                            
                            <!-- Message -->
                            <TextBlock TextWrapping="Wrap"
                                       TextAlignment="Center"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       Margin="0,0,0,16">
                                <Run Text="Click"/>
                                <Run Text="Add Column" FontWeight="Bold"/>
                                <Run Text="above to create your first column. Columns define what data appears in this report or label."/>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </Grid>
            </GroupBox>
        </Grid>
    </ScrollViewer>
</UserControl>

